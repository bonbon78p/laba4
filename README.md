# Лабораторная работа №4. Взаимодействие с сервером.
Выполнил: Перцов Богдан, ИСП-221С

## Что делает приложение?

Это приложение, отображающее текущий курс Bitcoin в USD и историю его изменений. Данные берутся с API Coindesk, а история сохраняется локально с помощью Room

## 1. Обзор MainActivity

MainActivity отвечает за:

• Взаимодействие с пользователем: отображение данных и обработка обновлений.

• Запрос данных: периодически запрашивает текущий курс Bitcoin у API Coindesk через fetchAndSavePrice().

• Взаимодействие с базой данных: сохраняет и загружает данные из базы данных Room через AppDatabase и BitcoinPriceDao.

• Обновление пользовательского интерфейса (UI): отображает текущий курс и историю изменений в RecyclerView.


## 2. Элементы UI

Экран MainActivity содержит:

• TextView (bitcoinPriceTextView): Отображение текущего курса Bitcoin.

• RecyclerView (recyclerView): Отображение истории изменений курса.


## 3. Обработка ввода пользователя (Обновление курса)

Приложение автоматически обновляет курс Bitcoin каждые 20 секунд. Процесс включает:

1. Запрос данных: fetchAndSavePrice() выполняет HTTP-запрос к API Coindesk.
2. Обработка ответа: Полученный JSON-ответ парсится с помощью Gson. 
3. Сохранение в базу данных: Курс и время сохраняются в базе данных Room через BitcoinPriceDao.
4. Обновление UI: updateUI() обновляет TextView с текущим курсом и RecyclerView с историей. В случае неудачных попыток выводится сообщение об ошибке.


## 4. Запрос к API (fetchBitcoinPrice)

Функция fetchBitcoinPrice() использует OkHttp для отправки GET-запроса к https://api.coindesk.com/v1/bpi/currentprice.json. Она обрабатывает возможные ошибки сети и возвращает JSON-ответ или null в случае неудачи.

## 5. Взаимодействие с базой данных Room

• Сохранение курса (BitcoinPriceDao.insert): Новый курс Bitcoin сохраняется в таблице bitcoin_price.

• Загрузка истории (BitcoinPriceDao.getAllPrices): updateUI() запрашивает всю историю курсов, отсортированную по времени (в обратном порядке).


## 6. Использование библиотек

• Room: Используется для работы с локальной базой данных.

• OkHttp: Используется для выполнения HTTP-запросов.

• Gson: Используется для парсинга JSON-ответов.

• RecyclerView: Используется для отображения истории курсов.

• ListAdapter: Эффективно обновляет RecyclerView при изменении данных.

## Сборка и запуск

1. Клонирование: Клонируйте репозиторий с помощью git clone [URL репозитория].
2. Открытие проекта: Откройте каждый проект (l31 и l32) в Android Studio.
3. Запуск: Запустите каждое приложение на эмуляторе или устройстве Android.
